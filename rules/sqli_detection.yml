id: sqli_detection
title: SQL Injection Attempt Detected
description: Detects common SQL injection patterns in web server access logs
severity: critical
status: active
author: Sentinel
tags:
  - attack.initial_access
  - attack.t1190

logsource:
  category: web

detection:
  selection:
    "raw|re": "(?i)(union\\s+select|or\\s+1\\s*=\\s*1|'\\s*or\\s*'|;\\s*drop\\s+|--\\s*$|/\\*.*\\*/|benchmark\\(|sleep\\(|load_file\\(|into\\s+outfile)"
  filter:
    "raw|contains": "/health"
  condition: selection and not filter

response:
  - type: block_ip
    target_field: source_ip
