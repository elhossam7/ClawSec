{{define "rules-content"}}
<div class="card">
    <div class="card-header">
        <div>
            <div class="card-title">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14.5 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V7.5L14.5 2z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                    <line x1="10" y1="9" x2="8" y2="9"/>
                </svg>
                Detection Rules
            </div>
            <div class="card-subtitle">SIGMA-compatible detection rules with Sentinel response extensions</div>
        </div>
        <span class="mono-text" style="font-size: 0.72rem; color: var(--text-muted);">{{len .Rules}} loaded</span>
    </div>

    {{if .Rules}}
    <div class="card-body-flush">
        {{range .Rules}}
        <div class="rule-item">
            <div class="rule-inner">
                <div class="rule-body">
                    <div class="rule-header">
                        {{severityBadge .Severity}}
                        <span class="rule-title">{{.Title}}</span>
                        {{if not .Enabled}}
                        <span class="rule-disabled-tag">disabled</span>
                        {{end}}
                    </div>
                    <p class="rule-desc">{{.Description}}</p>
                    <div class="rule-meta">
                        <span>ID: <span class="code-inline">{{.ID}}</span></span>
                        {{if .Tags}}
                        <div class="rule-tags">
                            {{range .Tags}}
                            <span class="rule-tag">{{.}}</span>
                            {{end}}
                        </div>
                        {{end}}
                        {{if .Correlation}}
                        <span>Threshold: <strong>{{.Correlation.Threshold}}</strong> in {{.Correlation.Window}}</span>
                        {{end}}
                    </div>
                </div>
                <div>
                    {{if .Enabled}}
                    <button hx-post="/api/rules/toggle/{{.ID}}" hx-vals='{"action":"disable"}' hx-target="#main-content" hx-swap="innerHTML"
                            class="btn btn-ghost btn-sm">Disable</button>
                    {{else}}
                    <button hx-post="/api/rules/toggle/{{.ID}}" hx-vals='{"action":"enable"}' hx-target="#main-content" hx-swap="innerHTML"
                            class="btn btn-success btn-sm">Enable</button>
                    {{end}}
                </div>
            </div>
        </div>
        {{end}}
    </div>
    {{else}}
    <div class="empty-state">
        <div class="empty-state-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14.5 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V7.5L14.5 2z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
        </div>
        <div class="empty-state-title">No Rules Loaded</div>
        <div class="empty-state-desc">Add SIGMA-compatible YAML rules to the rules directory</div>
    </div>
    {{end}}
</div>
{{end}}

{{define "incidents-content"}}
<div class="card">
    <div class="card-header">
        <div>
            <div class="card-title">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-danger)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                    <line x1="12" y1="9" x2="12" y2="13"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
                Incidents
            </div>
            <div class="card-subtitle">Security incidents detected by the engine</div>
        </div>
    </div>

    {{if .Incidents}}
    <div class="card-body-flush">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Severity</th>
                    <th>Title</th>
                    <th>Rule</th>
                    <th>Source IP</th>
                    <th>Status</th>
                    <th>Events</th>
                    <th>Created</th>
                </tr>
            </thead>
            <tbody>
                {{range .Incidents}}
                <tr>
                    <td>{{severityBadge .Severity}}</td>
                    <td class="td-primary">{{.Title}}</td>
                    <td><span class="code-inline">{{.RuleID}}</span></td>
                    <td><span class="mono-text">{{.SourceIP}}</span></td>
                    <td>{{statusBadge (printf "%s" .Status)}}</td>
                    <td><span class="mono-text">{{len .Events}}</span></td>
                    <td class="td-muted"><span class="mono-text">{{timeAgo .CreatedAt}}</span></td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{else}}
    <div class="empty-state">
        <div class="empty-state-icon" style="background: rgba(16,185,129,0.06);">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
        </div>
        <div class="empty-state-title">No Incidents</div>
        <div class="empty-state-desc">No security incidents have been recorded</div>
    </div>
    {{end}}
</div>
{{end}}

{{define "audit-content"}}
<div class="card">
    <div class="card-header">
        <div>
            <div class="card-title">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 20h9"/>
                    <path d="M16.5 3.5a2.121 2.121 0 013 3L7 19l-4 1 1-4L16.5 3.5z"/>
                </svg>
                Audit Log
            </div>
            <div class="card-subtitle">Every action taken by Sentinel is recorded here</div>
        </div>
    </div>

    {{if .Entries}}
    <div class="card-body-flush">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Timestamp</th>
                    <th>Action</th>
                    <th>Actor</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody>
                {{range .Entries}}
                <tr>
                    <td class="td-muted"><span class="mono-text">{{timeAgo .Timestamp}}</span></td>
                    <td class="td-primary">{{.Action}}</td>
                    <td style="color: var(--text-secondary);">{{.Actor}}</td>
                    <td style="max-width: 360px;">
                        <span style="font-size: 0.78rem; color: var(--text-secondary); display: block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{.Details}}</span>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{else}}
    <div class="empty-state">
        <div class="empty-state-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14.5 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V7.5L14.5 2z"/>
                <polyline points="14 2 14 8 20 8"/>
            </svg>
        </div>
        <div class="empty-state-title">No Audit Entries</div>
        <div class="empty-state-desc">Actions will appear here as they occur</div>
    </div>
    {{end}}
</div>
{{end}}
