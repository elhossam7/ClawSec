{{define "approval-content"}}
<!-- ═══ Pending Actions ═══ -->
<div class="card section-mb">
    <div class="card-header">
        <div>
            <div class="card-title">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--color-warning)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
                Pending Approval
                {{if .Pending}}
                <span class="severity-badge severity-medium">{{len .Pending}}</span>
                {{end}}
            </div>
            <div class="card-subtitle">Review and approve or deny proposed response actions</div>
        </div>
    </div>

    {{if .Pending}}
    <div class="card-body-flush">
        {{range .Pending}}
        <div class="action-card {{if .IncidentID}}action-card-ai{{end}}" id="action-{{.ID}}">
            <div class="action-card-inner">
                <div class="action-card-body">
                    <div class="action-card-header">
                        {{severityBadge .Severity}}
                        <span class="action-type">{{.Type}}</span>
                        <span class="action-target">{{.Target}}</span>
                        {{if .IncidentID}}
                        <span class="ai-proposed-badge">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/>
                            </svg>
                            AI Proposed
                        </span>
                        {{end}}
                    </div>
                    <p class="action-reason">{{.Reason}}</p>
                    {{if .IncidentID}}
                    <div class="ai-analysis-bar">
                        <span class="ai-analysis-label">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/>
                            </svg>
                            Incident
                        </span>
                        <span class="code-inline">{{.IncidentID}}</span>
                    </div>
                    {{end}}
                    <div class="action-meta">
                        <span>Rule: <span class="code-inline">{{.RuleID}}</span></span>
                        <span>Created: {{timeAgo .CreatedAt}}</span>
                        <span>Expires: {{timeAgo .ExpiresAt}}</span>
                    </div>
                </div>
                <div class="action-buttons">
                    <button hx-post="/api/approve/{{.ID}}" hx-target="#main-content" hx-swap="innerHTML"
                            class="btn btn-success btn-sm">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="20 6 9 17 4 12"/>
                        </svg>
                        Approve
                    </button>
                    <button hx-post="/api/deny/{{.ID}}" hx-target="#main-content" hx-swap="innerHTML"
                            class="btn btn-danger btn-sm">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                        Deny
                    </button>
                </div>
            </div>
        </div>
        {{end}}
    </div>
    {{else}}
    <div class="empty-state">
        <div class="empty-state-icon" style="background: rgba(16,185,129,0.06);">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--color-success)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                <path d="M9 12l2 2 4-4"/>
            </svg>
        </div>
        <div class="empty-state-title">No Pending Actions</div>
        <div class="empty-state-desc">All clear — no response actions require approval</div>
    </div>
    {{end}}
</div>

<!-- ═══ Recent Actions ═══ -->
<div class="card">
    <div class="card-header">
        <div class="card-title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
            </svg>
            Recent Actions
        </div>
    </div>

    {{if .Recent}}
    <div class="card-body-flush">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Type</th>
                    <th>Target</th>
                    <th>Status</th>
                    <th>Approved By</th>
                    <th>Time</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .Recent}}
                <tr>
                    <td class="td-primary" style="text-transform: uppercase; font-size: 0.72rem; letter-spacing: 0.03em;">{{.Type}}</td>
                    <td><span class="code-inline">{{.Target}}</span></td>
                    <td>{{statusBadge (printf "%s" .Status)}}</td>
                    <td class="td-muted">{{.ApprovedBy}}</td>
                    <td class="td-muted"><span class="mono-text">{{timeAgo .CreatedAt}}</span></td>
                    <td>
                        {{if eq (printf "%s" .Status) "executed"}}
                        <button hx-post="/api/rollback/{{.ID}}" hx-target="#main-content" hx-swap="innerHTML"
                                hx-confirm="Are you sure you want to rollback this action?"
                                class="btn btn-ghost btn-sm" style="color: #c084fc; border-color: rgba(168,85,247,0.2);">
                            <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="1 4 1 10 7 10"/>
                                <path d="M3.51 15a9 9 0 102.13-9.36L1 10"/>
                            </svg>
                            Rollback
                        </button>
                        {{end}}
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{else}}
    <div class="empty-state">
        <div class="empty-state-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                <line x1="3" y1="9" x2="21" y2="9"/>
                <line x1="9" y1="21" x2="9" y2="9"/>
            </svg>
        </div>
        <div class="empty-state-title">No Actions Yet</div>
        <div class="empty-state-desc">Actions will appear here as they are processed</div>
    </div>
    {{end}}
</div>
{{end}}
